<div class="row element-style">
  <div class="col-md-8 col-md-offset-2">
    <% if @errors %>
      <% @errors.each do |error| %>
        <div class="'has-error alert alert-danger alert-dismissable'">
          <button name="button" type="button" class="close" data-dismiss="alert">×</button>
          <%= error %>
        </div>
      <% end%>
    <% end%>
    <div class="progress progress-striped active">
      <div class="progress-bar progress-bar-success" style="width: <%= Random.rand(101) %>%"></div>
    </div>
    <form class="form-horizontal" action="/surveys/create" method="POST">
      <fieldset>
        <div class="row">
          <legend class="col-lg-12"><%= @current_user.positions.first.unit.campaign.name %></legend>
        </div>
        <div class="form-group org-panel">
          <div class="row">
            <label for="select" class="col-lg-12 control-label">Instrucciones de cumplimentación de la encuesta</label>
            <hr>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <table class="table table-striped table-hover ">
                <thead>
                  <th></th>
                </thead>
                <tbody>
                  <tr>
                    <td>Instrucción 1...</td>
                  </tr>
                  <tr>
                    <td>Instrucción 2...</td>
                  </tr>
                  <tr>
                    <td>Instrucción 3...</td>
                  </tr>
                  <tr>
                    <td>Instrucción 4...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="form-group">
          <div class="row">
            <label class="col-lg-12 control-label">¿En qué ha destinado el tiempo el último trimestre?</label>
          </div>
          <div class="row">
            <table class="table table-striped table-hover ">
              <thead>
                <th>Tarea</th>
                <th>% Tiempo</th>
                <th>Nº de tareas</th>
                <th>Tiempo mínimo</th>
                <th>Tiempo medio</th>
                <th>Tiempo máximo</th>
              </thead>
              <tbody>
                <% @current_user.positions.first.functions.each do |function| %>
                <tr>
                  <td>
                    <div>
                      <p>
                        <%= function.name %>
                        <input type="hidden" class="form-control input-sm task" type="text" id="inputSmall" value="<%= function.id %>" name="function_id">
                      </p>
                    </div>
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" name="time_per" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" name="num_task" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" name="min_time" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" name="avg_time" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" name="max_time" id="inputSmall">
                  </td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
        <div class="form-group">
          <div class="row">
            <label class="col-lg-12 control-label">Otras tareas realizadas: </label>
          </div>
          <div class="row">
            <table class="table table-striped table-hover ">
              <thead>
                <th></th>
                <th>Tarea</th>
                <th>% Tiempo</th>
                <th>Nº de tareas</th>
                <th>Tiempo mínimo</th>
                <th>Tiempo medio</th>
                <th>Tiempo máximo</th>
              </thead>
              <tbody id="other-tasks">
                <tr>
                  <td>
                    <td>
                      <input class="form-control input-sm task" type="text" id="inputSmall" placeholder="Otra tarea">
                    </td>
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" id="inputSmall">
                  </td>
                  <td>
                    <input class="form-control input-sm" type="text" id="inputSmall">
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <button type="reset" class="btn btn-danger pull-right" id="remove-task">Eliminar tarea</button>
          <button type="reset" class="btn btn-primary pull-right" id="add-task">Añadir tarea</button>
        </div>
      </fieldset>
      <div class="col-md-7">
        <a href="/surveys">
          <button type="reset" class="btn btn-primary">Cancelar</button>
        </a>
        <input type="hidden"value="<%= form_authenticity_token() %>" name="authenticity_token"/>
        <button type="submit" class="btn btn-success" id="submit-survey">Enviar encuesta</button>
      </div>
    </form>
  </div>
</div>

<script>
    $("#add-task").click(function() {
      taskTemplate = '<tr class="task-row"><td><td><input class="form-control input-sm" type="text" id="inputSmall" name="name" placeholder="Otra tarea"></td></td><td><input class="form-control input-sm" type="text" id="inputSmall"></td><td><input class="form-control input-sm" type="text" id="inputSmall"></td><td><input class="form-control input-sm" type="text" id="inputSmall"></td><td><input class="form-control input-sm" type="text" id="inputSmall"></td><td><input class="form-control input-sm" type="text" id="inputSmall"></td></tr>'
      if($(".task-row").length < 2) {
        $("#other-tasks").append(taskTemplate);
      }
    })

    $("#remove-task").click(function() {
      if($(".task-row").length >= 1) {
        $(".task-row").last().remove()
      }
    })

    // $("#submit-survey").click(function() {
    //   swal("Gracias!", "La encuesta se ha enviado correctamente!", "success");
    // })
</script>
